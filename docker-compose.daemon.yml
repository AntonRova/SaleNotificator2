version: '3.8'

# Alternative docker-compose using Python daemon scheduler
# This version allows changing check interval via environment variable
#
# Usage:
#   docker-compose -f docker-compose.daemon.yml up -d

services:
  price-notificator:
    build:
      context: .
      dockerfile: Dockerfile.daemon
    container_name: sale-notificator-daemon
    restart: unless-stopped

    volumes:
      # Mount your config directory (READ-ONLY for security)
      # Update the path on the left side to match your TrueNAS dataset path
      - /mnt/your-pool/apps/sale-notificator/config:/app/config:ro

      # Mount logs directory (WRITABLE)
      - /mnt/your-pool/apps/sale-notificator/logs:/app/logs

    environment:
      # Timezone for accurate logging (adjust to your timezone)
      - TZ=America/New_York

      # Check interval in seconds
      # Common values:
      #   900 = 15 minutes
      #   1800 = 30 minutes
      #   3600 = 1 hour (default)
      #   7200 = 2 hours
      #   21600 = 6 hours
      #   43200 = 12 hours
      #   86400 = 24 hours
      - CHECK_INTERVAL_SECONDS=3600

    # Resource limits (adjust based on your needs)
    deploy:
      resources:
        limits:
          cpus: '0.5'
          memory: 256M
        reservations:
          cpus: '0.1'
          memory: 64M

    # Logging configuration
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

# Examples of different check intervals:
#
# Every 30 minutes:
#   - CHECK_INTERVAL_SECONDS=1800
#
# Every 2 hours:
#   - CHECK_INTERVAL_SECONDS=7200
#
# Every 6 hours:
#   - CHECK_INTERVAL_SECONDS=21600
#
# Once per day:
#   - CHECK_INTERVAL_SECONDS=86400
